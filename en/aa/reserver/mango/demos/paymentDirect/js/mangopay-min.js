var mangoPay={cardRegistration:{init:function(a){_cardRegisterData=a},sendDataWithAjax:function(c,d,e,f){mangoPay._ajax({type:"post",url:_cardRegisterData.cardRegistrationURL,crossDomain:true,data:{data:_cardRegisterData.preregistrationData,accessKeyRef:_cardRegisterData.accessKey,cardNumber:d.cardNumber,cardExpirationDate:d.cardExpirationDate,cardCvx:d.cardCvx},success:function(a){var b="";if(a===null){b={errorCode:''}}else if(a.indexOf("data=")===0){b={data:a.replace("data=","")}}else{b={errorCode:a.replace("errorCode=","")}}mangoPay._ajax({type:"get",url:c,data:b,success:e,error:f})},error:f})},sendDataWithAjaxOrRedirect:function(a,b,c,d,e){if(mangoPay._browser.corsSupport()){mangoPay.cardRegistration.sendDataWithAjax(a,c,d,e);return}mangoPay.cardRegistration.sendDataWithRedirect(b,c)},sendDataWithRedirect:function(a,b){var c=document.createElement('form');c.setAttribute('action',_cardRegisterData.cardRegistrationURL);c.setAttribute('method','post');c.setAttribute('style','display: none');document.getElementsByTagName('body')[0].appendChild(c);c.appendChild(mangoPay._getInputElement('data',_cardRegisterData.preregistrationData));c.appendChild(mangoPay._getInputElement('accessKeyRef',_cardRegisterData.accessKey));c.appendChild(mangoPay._getInputElement('cardNumber',b.cardNumber));c.appendChild(mangoPay._getInputElement('cardExpirationDate',b.cardExpirationDate));c.appendChild(mangoPay._getInputElement('cardCvx',b.cardCvx));c.appendChild(mangoPay._getInputElement('returnURL',a));c.submit()}},_getInputElement:function(a,b){var c=document.createElement('input');c.setAttribute('type','hidden');c.setAttribute('name',a);c.setAttribute('value',b);return c},_ajax:function(a){var b=new XMLHttpRequest();var c="";for(key in a.data){c+=(c.length>0?'&':'')+key+"="+encodeURIComponent(a.data[key])}var d=a.url;if(a.type==="get"){d=a.url+(a.url.indexOf("?")>-1?'&':'?')+c}if(a.crossDomain&&!("withCredentials"in b)&&window.XDomainRequest){xdr=new XDomainRequest();xdr.onerror=function(){a.error(xdr)};xdr.onload=function(){a.success(xdr.responseText)};xdr.open(a.type,d);xdr.send(a.type==="post"?c:null);return}b.onreadystatechange=function(){if(b.readyState==4){if(b.status==200){a.success(b.responseText)}else{a.error(b,b.status,b.statusText)}}};b.open(a.type,d,true);if(a.type==="post"){b.setRequestHeader("Content-type","application/x-www-form-urlencoded")}b.send(a.type==="post"?c:null)},_browser:{corsSupport:function(){if("withCredentials"in new XMLHttpRequest()){return true}if(window.XDomainRequest){return true}return false}}};